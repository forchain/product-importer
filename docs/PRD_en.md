# Weidian Product Importer (weidian-importer)

## 1. Introduction

### 1.1 Project Overview

This project aims to develop an efficient product import and export system to simplify customer operations in product management. The system will support multiple product data formats for import and ensure data accuracy and consistency. Through automated processing, users can quickly generate export tables that meet requirements, thereby improving work efficiency and user experience.

## 2. System Requirements

### 2.1 Data Tables

#### 2.1.1 Import Table

The product import table provided by the customer contains the following columns:

- Product Name (TITLE)
- Product Price (PRICE)
- Product Size (SIZE)
- Product Notes (NOTES)
- Product Model (ITEM)

#### 2.1.2 Inventory Table

The product inventory table provided by the customer includes the following fields:

- Product ID
- Model ID
- Model Name

#### 2.1.3 Update Table

Generated by copying the update table template, it includes the following fields:

- Product ID
- Product Title
- Model ID
- Product Status

#### 2.1.4 New Product Table

Generated by copying the new product table template, it includes the following fields:

- Product Title
- Model Category 1
- Model Name 1
- Product Price
- Product Stock

### 2.2 Functional Requirements

#### 2.2.1 Update Table Generation

1. Scan each record in the inventory table.
1.1 Insert a record in the update table, filling in the following fields:
   - Product ID: Use the Product ID from the inventory table.
   - Product Title: Use the first record from the TITLE field in the import table.
   - Model ID: Use the Model ID from the inventory table.
   - Product Status:
     - Check the import table for this record by determining if the model name in the inventory table starts with the ITEM field content from the import table.
     - If found, the status is "On Sale"; otherwise, it is "Off Sale."

#### 2.2.2 New Product Table Generation

1. Look for all records in the import table that do not exist in the inventory table.
   - The condition for existence: whether the content of the product model field in the inventory table starts with the ITEM field content from the import table.
2. For each non-existent record, add a record in the new product table, filling in the following fields:
   - Product Title: Use the first record from the TITLE field in the import table.
   - Model Category 1: Set to "Uncategorized."
   - Model Name 1: Use the ITEM field from the import table and generate according to the following rules:
     Model Name (ITEM field) | Size (SIZE field) | Notes (NOTES field)
     If the size or notes content is empty, do not add that part.
   - Product Price: Use the PRICE field from the import table.
   - Product Stock: Set to 100.

### 2.3 Processing Flow

1. Import Data Processing:
   - Determine whether the records in the import table exist in the inventory table.
   - If they exist, mark them as "On Sale" in the update table.
   - If they do not exist, mark them as "Off Sale" in the update table.
2. New Product Processing:
   - Check for records that exist in the import table but do not exist in the inventory table.
   - Add these new products to the new product table.
   - Generate new model names, including model, size, and notes information (if any).

### 2.4 Web Mode Support

1. **Startup Parameters**:
   - Supports enabling Web mode by adding the `web` parameter at startup.
   
2. **Page Functions**:
   - After startup, a Web page will open, allowing users to upload import and inventory files.
   - The page provides a "Generate" button; when clicked, the system will process the uploaded files and generate the update product table and new product table.
   - Once generation is complete, the system will automatically download the update product table and new product table.

## 3. Requirement Priority

- High

## 4. Acceptance Criteria

- The update table is correctly generated, containing all records from the inventory table, and correctly marks the product status.
- The new product table is correctly generated, containing all records that exist in the import table but do not exist in the inventory table.
- All data fields in the tables are correctly filled.
- The product stock field in the new product table is uniformly set to 100.
- Both the update table and the new product table are generated by copying the respective templates.
- The Model Name 1 field in the new product table correctly includes model, size, and notes information, omitting empty values according to the rules.
- The Web page can start normally, supporting file upload and download functions.

### Related Documents
- Documentation for Weidian product import [link](https://vmspub.weidian.com/gaia/55141/134c563b.html)
- [产品需求文档 (PRD)](Docs/PRD.md)  <!-- 新增中文文档链接 -->