# 产品需求文档

## 1. 简介

### 1.1 项目概述

本项目旨在开发一个高效的商品导入导出系统，以简化客户在商品管理过程中的操作。该系统将支持多种商品数据格式的导入，并确保数据的准确性和一致性。通过自动化处理，用户能够快速生成符合要求的导出表格，从而提高工作效率和用户体验。

## 2. 系统需求

### 2.1 数据表格

#### 2.1.1 导入表格

客户提供的商品导入表格包含以下列：

- 商品名（TITLE）
- 商品价格（PRICE）
- 商品尺寸（SIZE）
- 商品备注（NOTES）
- 商品型号（ITEM）

#### 2.1.2 库存表

客户提供的商品库存表，包含以下字段：

- 商品ID
- 型号ID
- 型号名

#### 2.1.3 更新表

通过复制更新表模板生成，包含以下字段：

- 商品ID
- 商品标题
- 型号ID
- 商品状态

#### 2.1.4 新增产品表

通过复制新增产品表模板生成，包含以下字段：

- 商品标题
- 型号分类1
- 型号名称1
- 商品价格
- 商品库存

### 2.2 功能需求

#### 2.2.1 更新表生成

1. 扫描库存表的每一条记录
1.1 在更新表中插入一条记录，填充以下字段：
   - 商品ID：使用库存表的商品ID
   - 商品标题：使用导入表的TITLE字段的第一条记录
   - 型号ID：使用库存表的型号ID
   - 商品状态：
     - 在导入表中查找该记录，查找方法为：库存表的型号名是否以导入表的ITEM字段内容开头
     - 如果找到，则状态为"上架"，否则为"下架"

#### 2.2.2 新增产品表生成

1. 在导入表中查找所有在库存表中不存在的记录
   - 判断存在的条件：库存表中商品型号字段的内容是否以导入表的ITEM字段的内容开头
2. 对于每条不存在的记录，在新增产品表中添加一条记录，填充以下字段：
   - 商品标题：使用导入表的TITLE字段的第一条记录
   - 型号分类1：设置为"未分类"
   - 型号名称1：使用导入表的ITEM字段，并按照以下规则生成：
     型号名(ITEM字段) | 尺寸(SIZE字段) | 备注(NOTES字段)
     如果尺寸或备注内容为空，则不添加这块内容
   - 商品价格：使用导入表的PRICE字段
   - 商品库存：设置为100

### 2.3 处理流程

1. 导入数据处理：
   - 判断导入表的记录是否存在于库存表
   - 如果存在，则在更新表中标记为"上架"
   - 如果不存在，则在更新表中标记为"下架"
2. 新增产品处理：
   - 检查导入表中存在但库存表中不存在的记录
   - 将这些新增产品添加到新增产品表中
   - 生成新的型号名称，包含型号、尺寸和备注信息（如果有）

### 2.4 Web模式支持

1. **启动参数**：
   - 支持通过启动时添加 `web` 参数来启用 Web 模式。
   
2. **页面功能**：
   - 启动后将打开一个 Web 页面，用户可以在页面上上传导入文件和库存文件。
   - 页面提供一个“生成”按钮，用户点击后，系统将处理上传的文件并生成更新商品表格和新增商品表格。
   - 生成完成后，系统将自动下载更新商品表格和新增商品表格。

## 3. 需求优先级

- 高

## 4. 验收标准

- 更新表正确生成，包含所有库存表中的记录，并正确标记商品状态
- 新增产品表正确生成，包含所有在导入表中存在但库存表中不存在的记录
- 所有表格的数据字段正确填充
- 新增产品表的商品库存字段统一设置为100
- 更新表和新增产品表都是通过复制相应的模板生成
- 新增产品表的型号名称1字段正确包含型号、尺寸和备注信息，并按规则省略空值
- Web 页面能够正常启动，支持文件上传和下载功能
